var Travelsoft=Travelsoft||{};!function(e){"use strict";e.SITE_ADDRESS="https://vetliva.ru",e.VIDEO_URL="https://www.youtube.com/embed/",e.REQUEST_URL=e.SITE_ADDRESS+"/travelsoft.pm",e.JS_URL=e.REQUEST_URL+"/assets/js",e.CSS_URL=e.REQUEST_URL+"/assets/css"}(Travelsoft),function(e){"use strict";e.utils={callbacks:{},makeid:function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;a<5;a++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},sendRequest:function(t,a,n){var s,r=!1,i="cb"+String(Math.random()).slice(-6),l=e.REQUEST_URL+"/?",o=a;function c(){r||(delete e.utils.callbacks[i],console.warn("Query error "+l))}o.push("callback=Travelsoft.utils.callbacks."+i),o.push("method="+t),l+=o.join("&"),e.utils.callbacks[i]=function(t){r=!0,delete e.utils.callbacks[i],n(t)},(s=document.createElement("script")).type="text/javascript",s.onload=c,s.onerror=c,s.src=l,document.body.appendChild(s)},screen:function(e){var t="";return"string"==typeof e&&(t=e.replace(/&/g,"&amp;"),t=e.replace(/</g,"&lt;"),t=e.replace(/"/g,"&quot;"),t=e.replace(/>/g,"&gt;"),t=e.replace(/'/g,"&#039;"),t=e.replace(/script/g,""),t=e.replace(/onclick/g,""),t=e.replace(/onchange/g,""),t=e.replace(/onkeydown/g,""),t=e.replace(/onkeypress/g,""),t=e.replace(/onmouseout/g,""),t=e.replace(/onmouseover/g,"")),t},HWatcher:{__prev:null,__id:null,__parent:null,watch:function(e){var t=this;t.unwatch(e),t.__id=setInterval(function(){t.__prev!==e.scrollHeight&&(t.__parent&&(t.__parent.style.height=e.scrollHeight+10+"px"),t.__prev=e.scrollHeight)},100)},unwatch:function(e){this.__id&&(clearInterval(this.__id),this.__id=null,this.__prev=null,e.style.height=0)}}}}(Travelsoft),function(e){"use strict";function t(e){var t=n(a(e));return window.parent.document.body.appendChild(t),t}function a(t){return{styles:{position:"absolute",display:"none",top:t.top+6+"px",left:t.left+"px",width:t.width+"px",height:t.height+"px",border:"1px solid #ccc","box-sizing":"border-box","z-index":10,"padding-right":"1px"},attributes:{src:"about:blank",id:t.iframe_id,scrolling:t.scrolling?"yes":"no",className:"iframe-plugin"},iframeContent:"",iframeStylesheets:['<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">','<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">'].join("")+[e.CSS_URL+`/forms/${t.plugin_name}.min.css?`+1e5*Math.random()].map(function(e){return`<link rel="stylesheet" href="${e}">`}).join("")+`<style>${e.utils.screen(t.css)}</style>`,iframeScripts:[e.JS_URL+`/bundles/${t.plugin_name}.js`].map(function(e){return`<script type="text/javascript" src="${e}"><\/script>`}).join("")+`<script>Travelsoft.${t.plugin_name}.init(${JSON.stringify({iframe_id:t.iframe_id,data:t.data,without:t.without})})<\/script>`}}function n(t){var a=document.createElement("iframe");for(var n in t.styles)a.style[n]=t.styles[n];for(var s in t.attributes)a[s]=t.attributes[s];return a.onload=function(){a.contentDocument.write(e.frames.template.replace("{{stylesheets}}",t.iframeStylesheets).replace("{{content}}",t.iframeContent).replace("{{scripts}}",t.iframeScripts))},a}e.frames={template:'<!DOCTYPE html>\n                        <html>\n                            <head>\n                                <title>travelsoft partner module</title>\n                                <meta charset="UTF-8">\n                                {{stylesheets}}\n                            </head>\n                            <body>\n                                {{content}}\n                                {{scripts}}\n                            </body>\n                        </html>',render:{forms:{form:function(t){var a="search-forms-"+Math.ceil(1e3*Math.random()),s=n({styles:{width:"100%",border:"none"},attributes:{src:"about:blank",id:a,scrolling:"yes"},iframeContent:"",iframeStylesheets:['<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">','<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">'].join("")+[e.CSS_URL+"/select2.min.css",e.CSS_URL+"/daterangepicker.min.css",e.CSS_URL+"/forms/styles.min.css?"+1e5*Math.random()].map(function(e){return`<link rel="stylesheet" href="${e}">`}).join("")+`<style>${e.utils.screen(t.mainIframeCss)}</style>`,iframeScripts:(t.parent_iframe_id=a,[e.JS_URL+"/jquery-3.2.1.min.js",e.JS_URL+"/bootstrap.min.js",e.JS_URL+"/bundles/forms.js"].map(function(e){return`<script type="text/javascript" src="${e}"><\/script>`}).join("")+`<script>Travelsoft.forms.init(${JSON.stringify(t)})<\/script>`)});return document.getElementById(t.insertion_id).replaceChild(s,document.getElementById(t.insertion_id).querySelector("span")),s},select:function(e){return e.plugin_name="select",t(e)},children:function(e){return e.plugin_name="children",t(e)},datepicker:function(t){var s,r,i=t.left-303+t.width;return t.plugin_name="datepicker",(r=a(t)).styles.width="303px",r.styles.left=i+"px",r.iframeStylesheets+=`<link rel="stylesheet" href="${e.CSS_URL+"/daterangepicker.min.css"}">`+r.iframeStylesheets,r.iframeScripts=function(t){return[e.JS_URL+"/jquery-3.2.1.min.js",e.JS_URL+"/moment.min.js",e.JS_URL+"/moment_locales.min.js",e.JS_URL+"/daterangepicker.min.js",e.JS_URL+`/bundles/${t.plugin_name}.js`].map(function(e){return`<script type="text/javascript" src="${e}"><\/script>`}).join("")+`<script>Travelsoft.${t.plugin_name}.init(${JSON.stringify({iframe_id:t.iframe_id,start_date:t.data.start_date,end_date:t.data.end_date,format:t.data.format,date_separator:t.data.date_separator,defValue:t.data.defValue})})<\/script>`}(t),s=n(r),window.parent.document.body.appendChild(s),s}},searchResult:function(t){var a=t;a.page=1;var s=n({styles:{width:"100%",border:"none","z-index":10},attributes:{src:"about:blank",id:"search-result_"+t.insertion_id,scrolling:"no"},iframeContent:"",iframeStylesheets:['<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">','<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">'].join("")+[e.CSS_URL+"/responsiveslides.min.css",e.CSS_URL+"/search-result/styles.min.css"].map(function(e){return`<link rel="stylesheet" href="${e}">`}).join("")+`<style>${e.utils.screen(t.mainIframeCss)}</style>`,iframeScripts:["https://api-maps.yandex.ru/2.1/?lang=ru_RU",e.JS_URL+"/jquery-3.2.1.min.js",e.JS_URL+"/bootstrap.min.js",e.JS_URL+"/responsiveslides.min.js",e.JS_URL+"/pagenavigator.min.js",e.JS_URL+"/bundles/search_result.js"].map(function(e){return`<script type="text/javascript" src="${e}"><\/script>`}).join("")+`<script>Travelsoft.searchResult.init(${JSON.stringify(a)})<\/script>`});return document.getElementById(t.insertion_id).replaceChild(s,document.getElementById(t.insertion_id).querySelector("span")),s}}}}(Travelsoft),function(e,t){"use strict";function a(){for(var e=parent.document.querySelectorAll(".iframe-plugin"),t=document.querySelectorAll(".span-plugin"),a=0;a<e.length;a++)e[a].style.display="none";for(a=0;a<t.length;a++)t[a].innerHTML=t[a].innerHTML.replace(/<span class="iframe-closer">(.*)<\/span>/,"")}function n(e,a){var n=t(e.attr("href"));!function(e,t,a){var n=[];e.find("select[data-need-create-iframe-select=yes]").each(function(){var e,s=this,i=r(s,"select",!0,t,a);setInterval(function(){i.iframe.dataset.value&&i.iframe.dataset.value!==e&&(s.value=i.iframe.dataset.value,i.span.innerHTML=i.iframe.dataset.text,e=s.value,s.dispatchEvent(new Event("change")))},200),n.push(i)})}(n,a.selectIframeCss,a.parent_iframe_id),function(e,a,n){var r=[];e.find("input[data-need-create-iframe-datepicker=yes]").each(function(){var e,i=this,l=s(i,{start_date:t(i).data("start-date")||null,end_date:t(i).data("end-date")||null,format:t(i).data("format"),date_separator:t(i).data("date-separator"),defValue:i.value||null},!1,i.value||null,"datepicker",a,n);l.iframe.dataset.daterange=i.value,setInterval(function(){l.iframe.dataset.daterange!==e&&(e=l.iframe.dataset.daterange,l.span.innerHTML=l.iframe.dataset.daterange,i.value=l.iframe.dataset.daterange)},200),r.push(l)})}(n,a.datepickerIframeCss,a.parent_iframe_id),function(e,t,a){var n=[];e.find("select[data-need-create-iframe-children=yes]").each(function(){var e=r(this,"children",!1,t,a),s=document.createElement("span"),l="",o="";s.dataset.def_age=this.dataset.def_age,e.span.parentNode.insertBefore(s,e.span),this.dataset.def_age.length&&i(s,function(e){for(var t=[],a=0;a<e.length;a++)t.push(e[a]);return t}(this.dataset.def_age.split(";"))),e.iframe.dataset.children="",e.iframe.dataset.age="",setInterval(function(e,t){t.iframe.dataset.children!==l&&(l=t.iframe.dataset.children,t.span.innerHTML=t.iframe.dataset.children+'<span class="iframe-closer">&times;</span>',e.value=l,e.dispatchEvent(new Event("change"))),t.iframe.dataset.age!==o&&(o=t.iframe.dataset.age,i(s,""!==t.iframe.dataset.age?t.iframe.dataset.age.split(";"):[]))},200,this,e),n.push(e)})}(n,a.childrenIframeCss,a.parent_iframe_id),n.find("form").find("button").each(function(){t(this).on("click",function(e){window.parent.open(t(this).data("url")+"?"+t(this).closest("form").serialize(),"__blank"),e.preventDefault()})})}function s(a,n,s,r,i,l,o){var c,d="iframe-plugin-"+a.id,u=function(e,t,a){var n=document.createElement("span");n.id="span-for-"+e,n.className="form-control span-plugin",n.innerText=t,n.style.cursor="pointer",n.style.overflow="hidden",n.style["white-space"]="nowrap",n.style["text-overflow"]="ellipsis",n.style.display="inline-block",n.style["padding-right"]="22px",n.style["line-height"]="22px",a&&(n.dataset.iframeLink=a);return n}(a.id,r,d),p=e.frames.render.forms[i]({iframe_id:(c={iframe_id:d,self:a,data:n,scrolling:s,css:l,parentIframeId:o}).iframe_id,top:t(c.self).offset().top+t(parent.document.getElementById(c.parentIframeId)).offset().top+31,left:t(c.self).offset().left+t(parent.document.getElementById(c.parentIframeId)).offset().left,width:t(c.self).outerWidth(),without:"yes"===c.self.dataset.without,height:c.self.dataset.iframeSelectHeight?c.self.dataset.iframeSelectHeight:500,data:c.data,select_id:c.self.id,scrolling:c.self.scrolling?"yes":"no",css:c.css});return a.style.display="none",a.parentNode.insertBefore(u,a),{iframe:p,span:u}}function r(e,t,a,n,r){return s(e,function(e){for(var t=[],a=0;a<e.children.length;a++)t.push({selected:e.children[a].selected||!1,value:e.children[a].value,span_text:e.children[a].dataset.spanText,text:e.children[a].innerText});return t}(e),a,function(e){for(var t=0;t<e.children.length;t++)if(e.children[t].selected)return e.children[t].dataset.spanText;return e.children[0].dataset.spanText}(e),t,n,r)}function i(e,t){var a="";if(t.length)for(var n=0;n<t.length;n++)a+=`<input type="hidden" name="tpm_params[children_age][]" value="${t[n]}">`;e.innerHTML=a}e.forms={init:function(s){e.utils.sendRequest("GetFormsRenderData",["tpm_params[types]="+s.types.join("|"),"tpm_params[active]="+s.active,function(e){var a="";return t.isArray(e.def_objects)&&(a+="tpm_params[def_objects]="+e.def_objects.join("|")),a+="&"+window.parent.location.search.replace("?","").split("&").filter(function(e){return e.length>0&&0===e.indexOf("tpm_params")}).join("&")}(s)],function(s){return function(r){var i,l;r.isError?console.warn(r.errorMessage):(i=function(e,t){for(var a=e,n=0;n<t.types.length;n++)a[t.types[n]].url=t.url[n];return a}(r.data,s),l=e.utils.screen,document.body.innerHTML+=`<div class="container" id="container">\n                                            <div class="row">\n                                                \n                                                <ul class="nav nav-tabs">\n                                                    ${function(e){var t="";for(var a in e)e.hasOwnProperty(a)&&(t+=`<li ${e[a].tabIsActive?'class="active"':""}><a data-toggle="tab" href="#${l(a)}-form-area">${l(e[a].tabTitle)}</a></li>`);return t}(i)}\n                                                </ul>\n                                                <div class="tab-content clearfix">\n                                                    ${function(){var e,t="";for(var a in i)i.hasOwnProperty(a)&&(e=l(a),t+=`<div class="tab-pane ${i[a].tabIsActive?"active":""}" id="${e}-form-area">\n                                                                                    <form id="${a}-form">\n                                                                                        <div class="col-md-3 col-sm-6 col-xs-6">\n                                                                                            <div class="form-group">\n                                                                                                <label>\n                                                                                                    ${l(i[a].objects.title)}\n                                                                                                </label>\n                                                                                                <select data-need-create-iframe-select="yes" name="tpm_params[id][]" id="${e}-objects" class="form-control objects">\n                                                                                                    ${function(e){for(var t="",a=0;a<e.length;a++)t+=`<option data-span-text="${l(e[a].source_name)}" ${e[a].isSelected?'selected=""':""} value="${l(e[a].id)}">${l(e[a].name)}</option>`;return t}(i[a].objects.forSelect)}\n                                                                        </select>\n                                                                    </div>\n                                                                </div>\n                                                                <div class="col-md-3 col-sm-6 col-xs-6">\n                                                                    <div class="form-group">\n                                                                        <label>\n                                                                            ${l(i[a].dates.title)}\n                                                                        </label>\n                                                                        <input data-need-create-iframe-datepicker="yes"  data-format="${l(i[a].dates.format)}" data-date-separator="${l(i[a].dates.separator)}" data-duration-title="${l(i[a].dates.durationTitle)}" value="${l(i[a].dates.defValue)}" name="tpm_params[date_range]" id="${e}-datepicker" type="text" class="datepicker form-control" >\n                                                                    </div>\n                                                                </div>\n                                                                <div class="col-md-2 col-sm-6 col-xs-6">\n                                                                    <div class="form-group">\n                                                                        <label>\n                                                                            ${l(i[a].adults.title)}\n                                                                        </label>\n                                                                        <select  id="${e}-adults-select" name="tpm_params[adults]" class="form-control select2">\n                                                                            <option data-span-text="1" ${1===Number(i[a].adults.defValue)?'selected=""':""} value="1">1</option>\n                                                                            <option data-span-text="2" ${2===Number(i[a].adults.defValue)?'selected=""':""} value="2">2</option>\n                                                                            <option data-span-text="3" ${3===Number(i[a].adults.defValue)?'selected=""':""} value="3">3</option>\n                                                                            <option data-span-text="4" ${4===Number(i[a].adults.defValue)?'selected=""':""} value="4">4</option>\n                                                                            <option data-span-text="5" ${5===Number(i[a].adults.defValue)?'selected=""':""} value="5">5</option>\n                                                                            <option data-span-text="6" ${6===Number(i[a].adults.defValue)?'selected=""':""} value="6">6</option>\n                                                                        </select>\n                                                                    </div>\n                                                                </div>\n                                                                <div class="col-md-2 col-sm-6 col-xs-6">\n                                                                    <div class="form-group">\n                                                                        <label>\n                                                                            ${l(i[a].children.title)}\n                                                                        </label>\n                                                                        <select data-def_age='${i[a].children_age.defValue.join(";")}' data-iframe-select-height="100" data-need-create-iframe-children="yes" name="tpm_params[children]" class="form-control" id="${e}-children">\n                                                                            <option data-span-text="0" ${0===i[a].children.defValue?'selected=""':""} value="0">0</option>\n                                                                            <option data-span-text="1" ${1===i[a].children.defValue?'selected=""':""} value="1">1</option>\n                                                                            <option data-span-text="2" ${2===i[a].children.defValue?'selected=""':""} value="2">2</option>\n                                                                            <option data-span-text="3" ${3===i[a].children.defValue?'selected=""':""} value="3">3</option>\n                                                                            <option data-span-text="4" ${4===i[a].children.defValue?'selected=""':""} value="4">4</option>\n                                                                        </select>\n                                                                    </div>\n                                                                </div>\n                                                                <div class="col-md-2 col-sm-6 col-xs-6">\n                                                                    <div class="form-group btn-search-area">\n                                                                        <button data-url="${l(i[a].url)}" data-onclick-handler-name="search" type="button" class="btn btn-primary">${l(i[a].button.title)}</button>\n                                                                    </div>\n                                                                </div>\n                                                            </form>\n                                                        </div>`);return t}()}\n                                                </div>\n                                            </div>\n                                        </div>`,e.utils.HWatcher.__parent=window.parent.document.getElementById(s.parent_iframe_id),e.utils.HWatcher.watch(document.body),setTimeout(function(){t(".nav-tabs a").each(function(){var e=t(this);e.parent().hasClass("active")?n(e,s):e.one("shown.bs.tab",function(){n(e,s)})}),parent.document.addEventListener("click",function(){a()}),document.addEventListener("click",function(e){var t,n;if("SPAN"===e.target.nodeName&&e.target.className.indexOf("span-plugin")>-1&&e.target.dataset.iframeLink)return n="block"===(t=parent.document.getElementById(e.target.dataset.iframeLink)).style.display,a(),void(n||(t.style.display="block",e.target.innerHTML=e.target.innerText+'<span class="iframe-closer">&times;</span>'));a()})},100))}}(s))}}}(Travelsoft,jQuery);
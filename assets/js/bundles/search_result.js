var Travelsoft=Travelsoft||{};(function(a){"use strict";a.SITE_ADDRESS="https://vetliva.ru",a.VIDEO_URL="https://www.youtube.com/embed/",a.REQUEST_URL=a.SITE_ADDRESS+"/travelsoft.pm",a.JS_URL=a.REQUEST_URL+"/assets/js",a.CSS_URL=a.REQUEST_URL+"/assets/css"})(Travelsoft);(function(a){"use strict";a.utils={callbacks:{},makeid:function(){for(var b="",c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",d=0;5>d;d++)b+=c.charAt(Math.floor(Math.random()*c.length));return b},sendRequest:function(b,c,d){function f(){g||(delete a.utils.callbacks[h],console.warn("Query error "+j))}var g=!1,h="cb"+(Math.random()+"").slice(-6),j=a.REQUEST_URL+"/?",k=c,l;k.push("callback=Travelsoft.utils.callbacks."+h),k.push("method="+b),j+=k.join("&"),a.utils.callbacks[h]=function(m){g=!0,delete a.utils.callbacks[h],d(m)},l=document.createElement("script"),l.type="text/javascript",l.onload=f,l.onerror=f,l.src=j,document.body.appendChild(l)},screen:function(b){var c="";return"string"==typeof b&&(c=b.replace(/&/g,"&amp;"),c=b.replace(/</g,"&lt;"),c=b.replace(/"/g,"&quot;"),c=b.replace(/>/g,"&gt;"),c=b.replace(/'/g,"&#039;"),c=b.replace(/script/g,""),c=b.replace(/onclick/g,""),c=b.replace(/onchange/g,""),c=b.replace(/onkeydown/g,""),c=b.replace(/onkeypress/g,""),c=b.replace(/onmouseout/g,""),c=b.replace(/onmouseover/g,"")),c},HWatcher:{__prev:null,__id:null,__parent:null,watch:function(b){var c=this;c.unwatch(b),c.__id=setInterval(function(){c.__prev!==b.scrollHeight&&(c.__parent&&(c.__parent.style.height=b.scrollHeight+10+"px"),c.__prev=b.scrollHeight)},100)},unwatch:function(b){this.__id&&(clearInterval(this.__id),this.__id=null,this.__prev=null,b.style.height=0)}}}})(Travelsoft);(function(a,b,c,d){"use strict";function f(y){var z=y.find(".slide-room-lg"),A=y.find(".slide-room-sm");z.owlCarousel({singleItem:!0,autoPlay:!1,navigation:!0,navigationText:["<span class='prev-next-room prev-room'></span>","<span class='prev-next-room next-room'></span>"],pagination:!1}),A.owlCarousel({mouseDrag:!1,navigation:!0,navigationText:["<span class='prev-next-room prev-room'></span>","<span class='prev-next-room next-room'></span>"],itemsCustom:[[320,3],[480,5],[768,6],[992,7],[1200,8]],pagination:!1}),b(".slide-room-sm").on("click",".owl-item",function(B){if(B.preventDefault(),b(this).hasClass("synced"))return!1;b(".synced").removeClass("synced"),b(this).addClass("synced");var C=b(this).data("owlItem");z.data("owlCarousel").goTo(C)})}function g(y){var z=y.data("coords-data"),A=null,B=[];if(b.isArray(z))if(1===z.length)A=new d.Map(y.attr("id"),{center:[+z[0].lat,+z[0].lng],zoom:9,controls:["zoomControl","fullscreenControl"]}),A.geoObjects.add(new d.Placemark(A.getCenter(),{balloonContent:z[0].content}));else{A=new d.Map(y.attr("id"),{center:[0,0],zoom:8,controls:["zoomControl","fullscreenControl"]});for(var C=0;C<z.length;C++)B.push([z[C].lat,z[C].lng]);d.route(B,{mapStateAutoApply:!0}).then(function(D){var F,E=D.getWayPoints();A.geoObjects.add(D),E.options.set("preset","islands#blueStretchyIcon");for(var G=0;G<z.length;G++)F=E.get(G),F.properties.set("iconContent",z[G].title),F.options.set("hasBalloon",!1)})}}function h(y){y.css({opacity:0.4})}function j(y){y.css({opacity:1})}function k(y,z,A,B){var C=a.utils.makeid();return`<div class="panel panel-default">
                        <div class="panel-heading">
                          <h4 class="panel-title">
                                  <a data-toggle="collapse" data-parent="#${A}" href="#collapse-${C}">
                                    ${y}
                                  </a>
                            </h4>
                        </div>
                        <div id="collapse-${C}" class="panel-collapse collapse ${B}">
                          <div class="panel-body">
                              ${z}
                          </div>
                        </div>
                    </div>`}function l(y){document.body.innerHTML=y,a.utils.HWatcher.__parent=window.parent.document.getElementById("search-result"),a.utils.HWatcher.watch(document.getElementById("container"))}function m(y){var z=a.utils.screen;x[y.pager.page]=`<div class="container" id="container">
                                                        ${function(A){return A.length?A.map(function(B){return`<div class="row">
                                                                                    <div class="thumbnail row-flex row-flex-wrap mrtb-10">
                                                                                        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                                                                                        ${function(C){return C?`<img class="main-img" src="${z(a.SITE_ADDRESS+B.imgSrc)}">`:``}(B.imgSrc)}
                                                                                        </div>
                                                                                        <div class="col-lg-8 col-md-8 col-sm-8 col-xs-12 flex-col">
                                                                                            <div class="name">${z(B.name)}</div>
                                                                                            <div class="stars-block">
                                                                                                ${function(C){for(var D=``,E=1;E<=C;E++)D+=`<span class="glyphicon glyphicon-star" aria-hidden="true"></span>`;return D}(B.stars)}
                                                                                            </div>
                                                                                            <ul>
                                                                                         ${function(C){var D="";return C.address&&(D+=`<li><span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span> ${z(C.address)}</li>`),C.route&&(D+=`<li><span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span> ${z(C.route)}</li>`),C.days&&(D+=`<li><span class="glyphicon glyphicon-time" aria-hidden="true"></span> Количество дней: ${z(C.days)}</li>`),C.duration_time&&(D+=`<li><span class="glyphicon glyphicon-time" aria-hidden="true"></span> Количество часов: ${z(C.duration_time)}</li>`),B.text.distance.minsk&&(D+=`<li><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> Расстояние до Минска: ${z(B.text.distance.minsk)} км</li>`),B.text.distance.center&&(D+=`<li><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> Расстояние до цента: ${z(B.text.distance.center)} км</li>`),B.text.distance.airport&&(D+=`<li><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> Расстояние до аэропорта: ${z(B.text.distance.airport)} км</li>`),D}(B.text)}
                                                                                                
                                                                                            </ul>
                                                                                            <div class="show-offers-block flex-grow">
                                                                                                <div class="details-links">
                                                                                                    <a data-request='${JSON.stringify(B.request)}' class="detail-link __desc" href="#">Описание</a>
                                                                                                    <a data-request='${JSON.stringify(B.request)}' class="detail-link __on-map" href="#">На карте</a>
                                                                                                    <a data-request='${JSON.stringify(B.request)}' class="detail-link __video" href="#">Видео</a>
                                                                                                </div>
                                                                                                <button data-offers-request='${JSON.stringify(B.request)}' class="btn btn-primary show-offers" type="button"><span class="price-from">${B.text.price}</span> <span class="chevron glyphicon glyphicon-chevron-down" aria-hidden="true"></button>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>`}).join(""):`<div class="row">
                                                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">По Вашему запросу ничего не найдено.</div>
                                                                                </div>`}(y.items||[])}
                                                        <div class="row text-right">${function(A){return new c(function(B){for(var C=[],D=0;D<B;D++)C.push(D);return C}(A.records),A.numberPerPage).page(A.page).getHtml()}(y.pager)}
                                        </div>
                                                </div>`,l(x[y.pager.page])}function n(y){"string"==typeof x[y.page]?l(x[y.page]):a.utils.sendRequest("GetSearchResultRenderData",[function(){var z=window.parent.location.search.replace("?","").split("&").filter(function(A){return 0<A.length&&0===A.indexOf("tpm_params")});return z.push("tpm_params[type]="+y.type),z.push("tpm_params[page]="+y.page),z.push("tpm_params[number_per_page]="+y.numberPerPage),z.push("tpm_params[agent]="+y.agent),z.push("tpm_params[hash]="+y.hash),z.join("&")}()],function(z){return function(A){var B=A;B.isError&&(console.warn(A.errorMessage),m({items:[],pager:{page:1,numberPerPage:0}})),B.data.pager.numberPerPage=z.numberPerPage,m(B.data)}}(y))}function o(y,z,A){var B=b(".pagination li.active a").data("page"),C=a.utils.screen;z.find(".info-block").remove(),z.append(`
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 collapsing-block offers hidden">
                <div style="width: 100%">
                    ${function(D){for(var E="",F=0;F<D.length;F++)E+=`<div class="row offer-row mrtb-10">
                                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-6">
                                    ${D[F].date?`<b>${C(D[F].date)}</b>`:D[F].img_src?`<img class="main-img" src="${a.SITE_ADDRESS+"/"+C(D[F].img_src)}">`:``}</b>
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-6">
                                    ${D[F].service?`<div class="name">${C(D[F].service)}</div><h5>${C(D[F].rate)}</h5>`:`<div class="name">${C(D[F].service)}</div>`}
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 text-right">
                                    <b>${C(D[F].price)}</b>${D[F].citizenprice?`<br><small>${D[F].citizenprice}</small>`:``}
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 text-right">
                                    <button data-add2cart="${C(D[F].add2cart)}" class="btn btn-primary booking" type="button">Бронировать</button>
                                </div>
                            </div>`;return E}(y)}
                </div>
            </div>
        `),x[B?B:1]=b("body").html(),z.find(".offers").removeClass("hidden"),"function"==typeof A&&A()}function p(y,z,A){z.find(".info-block").remove(),z.append(`
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 collapsing-block info-block hidden">
                <div style="width: 100%">${y.message}</div>
        </div>`),z.find(".info-block").removeClass("hidden"),"function"==typeof A&&A()}function q(y){y.find("span.chevron").removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up")}function r(){b(".show-offers").each(function(){s(b(this))})}function s(y){y.find("span.chevron").removeClass("glyphicon-chevron-up").addClass("glyphicon-chevron-down")}function t(y,z,A){var B=null===y?null:y.hasClass("hidden");b(".collapsing-block").addClass("hidden"),null===B?"function"==typeof z&&z():B?(y&&y.removeClass("hidden"),"function"==typeof z&&z()):(y&&y.addClass("hidden"),"function"==typeof A&&A())}function u(y,z,A){var B=b(".pagination li.active a").data("page"),C=a.utils.makeid(),D="accordion-"+a.utils.makeid(),E="in";z.find(".info-block").remove(),z.append(`
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 collapsing-block detail-desc-block hidden">
                <div style="width: 100%">
                    ${function(F){var G=``;return b.isArray(F.pictures.big)&&(G+=`<section id="${C}" class="detail-slider">
                                    <div class="slider-room-lg">
                                    <div class="slide-room-lg">
                                        ${function(H){G="";for(var I=0;I<H.length;I++)G+=`<img src="${a.SITE_ADDRESS+H[I]}">`;return G}(F.pictures.big)}
                                    </div>
                                </div>
                                <div class="slider-room-sm">
                                    <div class="row">
                                        <div class="col-md-8 col-md-offset-2">
                                            <div class="slide-room-sm">
                                                ${function(H){G="";for(var I=0;I<H.length;I++)G+=`<img src="${a.SITE_ADDRESS+H[I]}">`;return G}(F.pictures.small)}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>`),G+=`<div class="panel-group" id="${D}">`,F.desc&&(G+=k("\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435",F.desc,D,E),E=""),F.program&&(G+=k("\u041F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0430 \u0442\u0443\u0440\u0430",F.program,D,E),E=""),F.profiles&&(G+=k("\u041F\u0440\u043E\u0444\u0438\u043B\u044C",function(H){var I=`<div class="featured-service">`;for(var J in H.TYPE_GROUP)I+=`<div class="list-service-section">${H.TYPE_SECTIONS?`${H.TYPE_SECTIONS[J].PICTURE.SRC?`<div class="icon-service" style="float:left; top:2px"><img src="${a.SITE_ADDRESS+H.TYPE_SECTIONS[J].PICTURE.SRC}"></div>`:``}
                                                                            <h4>${H.TYPE_SECTIONS[J].TITLE}</h4>`:``}
                                                                            
                                                                        </div>
                                                                        <ul class="service-accmd">
                                                                            ${function(K){var L="";for(var M in K)L+=`<li><div><img src="${a.SITE_ADDRESS}/local/templates/travelsoft/images/icon-check.png" alt=""></div>${K[M].TITLE} ${K[M].PAID?`<a data-content="За дополнительную плату">(<i class="fa fa-dollar"></i>)</a>`:``}</li>`;return L}(H.TYPE_GROUP[J])}
                                                                        </ul>`;return I+="</div>",I}(F.profiles),D,E),E=""),F.services&&(G+=k("\u0423\u0441\u043B\u0443\u0433\u0438",function(H){var I=`<div class="featured-service">`;for(var J in H.SERVICES_GROUP)I+=`<div class="list-service-section">
                                                                            ${H.SERVICES_SECTIONS[J].PICTURE.SRC?`<div class="icon-service" style="float:left; top:2px"><img src="${a.SITE_ADDRESS+H.SERVICES_SECTIONS[J].PICTURE.SRC}"></div>`:``}
                                                                            <h4>${H.SERVICES_SECTIONS[J].TITLE}</h4>
                                                                        </div>
                                                                        <ul class="service-accmd">
                                                                            ${function(K){var L="";for(var M in K)L+=`<li><div><img src="${a.SITE_ADDRESS}/local/templates/travelsoft/images/icon-check.png" alt=""></div>${K[M].TITLE}</li>`;return L}(H.SERVICES_GROUP[J])}
                                                                        </ul>`;return I+="</div>",I}(F.services),D,E),E=""),F.medecine_services&&(G+=k("\u041C\u0435\u0434\u0438\u0446\u0438\u043D\u0441\u043A\u0438\u0435 \u0441\u043B\u0443\u0433\u0438",function(H){var I=`<div class="featured-service">`;for(var J in H.MED_SERVICES_GROUP)I+=`<div class="list-service-section">
                                                                            ${H.MED_SERVICES_SECTIONS[J].PICTURE.SRC?`<div class="icon-service" style="float:left; top:2px"><img src="${a.SITE_ADDRESS+H.MED_SERVICES_SECTIONS[J].PICTURE.SRC}"></div>`:``}
                                                                            <h4>${H.MED_SERVICES_SECTIONS[J].TITLE}</h4>
                                                                        </div>
                                                                        <ul class="service-accmd">
                                                                            ${function(K){var L="";for(var M in K)L+=`<li><div><img src="${a.SITE_ADDRESS}/local/templates/travelsoft/images/icon-check.png" alt=""></div>${K[M].TITLE} ${K[M].PAID?`<a data-content="За дополнительную плату">(<i class="fa fa-dollar"></i>)</a>`:``}</li>`;return L}(H.MED_SERVICES_GROUP[J])}
                                                                        </ul>`;return I+="</div>",I}(F.services),D,E),E=""),F.children_services&&(G+=k("\u0423\u0441\u043B\u0443\u0433\u0438 \u0434\u043B\u044F \u0434\u0435\u0442\u0435\u0439",F.children_services,D,E),E=""),F.food&&(G+=k("\u041F\u0438\u0442\u0430\u043D\u0438\u0435",F.food,D,E),E=""),F.rooms_base&&(G+=k("\u041D\u043E\u043C\u0435\u0440\u043D\u0430\u044F \u0431\u0430\u0437\u0430",F.rooms_base,D,E),E=""),F.addinfo&&(G+=k("\u0414\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u0430\u044F \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F",F.addinfo,D,E),E=""),G+=`</div>`,G}(y)}
                </div>
            </div>
        `),x[B?B:1]=b("body").html(),z.find(".detail-desc-block").removeClass("hidden"),"function"==typeof A&&A(),f(b("#"+C))}function v(y,z,A){var B=b(".pagination li.active a").data("page"),C="map-"+a.utils.makeid();z.find(".info-block").remove(),z.append(`<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 collapsing-block show-on-map-block hidden">
                                        <div style="width: 100%">
                                            <div data-coords-data='${JSON.stringify(y)}' id="${C}"></div>
                                        </div>
                                    </div>`),x[B?B:1]=b("body").html(),z.find(".show-on-map-block").removeClass("hidden"),"function"==typeof A&&A(),g(b(`#${C}`))}function w(y,z,A){var B=b(".pagination li.active a").data("page");z.find(".info-block").remove(),z.append(`<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 collapsing-block video-block hidden">
                                        <div style="width: 100%">
                                            <iframe class="video-frame" height="100%" width="100%" style="border: none;" src="${a.VIDEO_URL+y.code}" allowfullscreen=""></iframe>
                                        </div>
                                    </div>`),x[B?B:1]=b("body").html(),z.find(".video-block").removeClass("hidden"),"function"==typeof A&&A()}var x={};a.searchResult={init:function(y){var z=y;n(z),b(document).on("click",".show-offers",function(A){var B=b(this),C=B.closest(".thumbnail"),D=C.find(".offers");D.length?t(D,function(){q(B)},function(){s(B)}):(t(null,function(){r()}),q(B),h(B),p({message:"\u0418\u0434\u0435\u0442 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u043F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u0439. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u043E\u0434\u043E\u0436\u0434\u0438\u0442\u0435..."},C),a.utils.sendRequest("GetOffersRenderData",[B.data("offers-request").join("&")],function(E){return function(F){return F.isError?(console.warn(F.errorMessage),void p({message:"\u041F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u044F \u043E\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044E\u0442."},E)):void o(F.data,E,function(){j(B)})}}(C))),A.preventDefault()}),b(document).on("click",".detail-link.__desc",function(A){var B=b(this),C=B.closest(".thumbnail"),D=C.find(".detail-desc-block");D.length?t(D,function(){r()},function(){r()}):(t(null,function(){r()},function(){r()}),h(B),p({message:"\u0418\u0434\u0435\u0442 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u0438. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u043E\u0434\u043E\u0436\u0434\u0438\u0442\u0435..."},C),a.utils.sendRequest("GetDetailDescriptionRenderData",[B.data("request").join("&")],function(E){return function(F){return F.isError?(console.warn(F.errorMessage),void p({message:"\u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F \u043E\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442."},E)):void u(F.data,E,function(){j(B)})}}(C))),A.preventDefault()}),b(document).on("click",".detail-link.__on-map",function(A){var B=b(this),C=B.closest(".thumbnail"),D=C.find(".show-on-map-block");D.length?t(D,function(){r()},function(){r()}):(t(null,function(){r()},function(){r()}),h(B),p({message:"\u0418\u0434\u0435\u0442 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u043A\u0430\u0440\u0442\u044B. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u043E\u0434\u043E\u0436\u0434\u0438\u0442\u0435..."},C),a.utils.sendRequest("GetDetailMapRenderData",[B.data("request").join("&")],function(E){return function(F){return F.isError?(console.warn(F.errorMessage),void p({message:"\u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F \u043E\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442."},E)):void v(F.data,E,function(){j(B)})}}(C))),A.preventDefault()}),b(document).on("click",".detail-link.__video",function(A){var B=b(this),C=B.closest(".thumbnail"),D=C.find(".video-block");D.length?t(D,function(){r()},function(){r()}):(t(null,function(){r()},function(){r()}),h(B),p({message:"\u0418\u0434\u0435\u0442 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0432\u0438\u0434\u0435\u043E. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u043E\u0434\u043E\u0436\u0434\u0438\u0442\u0435..."},C),a.utils.sendRequest("GetDetailVideoRenderData",[B.data("request").join("&")],function(E){return function(F){return F.isError?(console.warn(F.errorMessage),void p({message:"\u0412\u0438\u0434\u0435\u043E \u043E\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442."},E)):F.data.code?void w(F.data,E,function(){j(B)}):void p({message:"\u0412\u0438\u0434\u0435\u043E \u043E\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442."},E)}}(C))),A.preventDefault()}),b(document).on("click",".pagination a",function(A){A.preventDefault(),b(this).parent().hasClass("active")||(z.page=b(this).data("page"),n(z))}),b(document).on("click",".booking",function(A){var B=b(this).data("add2cart");A.preventDefault(),B?window.parent.open(a.REQUEST_URL+"/?method=Booking&tpm_params[add2cart]="+B):alert("Some error. Please, try later.")})}}})(Travelsoft,jQuery,PageNavigator,ymaps);
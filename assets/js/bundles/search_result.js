var Travelsoft=Travelsoft||{};(function(a){"use strict";a.SITE_ADDRESS="https://vetliva.ru",a.VIDEO_URL="https://www.youtube.com/embed/",a.REQUEST_URL=a.SITE_ADDRESS+"/travelsoft.pm",a.JS_URL=a.REQUEST_URL+"/assets/js",a.CSS_URL=a.REQUEST_URL+"/assets/css"})(Travelsoft);(function(a){"use strict";a.utils={callbacks:{},makeid:function(){for(var n="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=0;5>s;s++)n+=t.charAt(Math.floor(Math.random()*t.length));return n},sendRequest:function(n,t,s){function d(){o||(delete a.utils.callbacks[l],console.warn("Query error "+c))}var o=!1,l="cb"+(Math.random()+"").slice(-6),c=a.REQUEST_URL+"/?",u=t,f;u.push("callback=Travelsoft.utils.callbacks."+l),u.push("method="+n),c+=u.join("&"),a.utils.callbacks[l]=function(g){o=!0,delete a.utils.callbacks[l],s(g)},f=document.createElement("script"),f.type="text/javascript",f.onload=d,f.onerror=d,f.src=c,document.body.appendChild(f)},screen:function(n){var t="";return"string"==typeof n&&(t=n.replace(/&/g,"&amp;"),t=n.replace(/</g,"&lt;"),t=n.replace(/"/g,"&quot;"),t=n.replace(/>/g,"&gt;"),t=n.replace(/'/g,"&#039;"),t=n.replace(/script/g,""),t=n.replace(/onclick/g,""),t=n.replace(/onchange/g,""),t=n.replace(/onkeydown/g,""),t=n.replace(/onkeypress/g,""),t=n.replace(/onmouseout/g,""),t=n.replace(/onmouseover/g,"")),t},HWatcher:{__prev:null,__id:null,__parent:null,watch:function(n){var t=this;t.unwatch(n),t.__id=setInterval(function(){t.__prev!==n.scrollHeight&&(t.__parent&&(t.__parent.style.height=n.scrollHeight+10+"px"),t.__prev=n.scrollHeight)},100)},unwatch:function(n){this.__id&&(clearInterval(this.__id),this.__id=null,this.__prev=null,n.style.height=0)}}}})(Travelsoft);(function(a,n,t){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):a(n||t)})(function(a){"use strict";var n=function(l,c,u){var f={invalid:[],getCaret:function(){try{var E,S=0,b=l.get(0),C=document.selection,D=b.selectionStart;return C&&-1===navigator.appVersion.indexOf("MSIE 10")?(E=C.createRange(),E.moveStart("character",-f.val().length),S=E.text.length):(D||"0"===D)&&(S=D),S}catch(R){}},setCaret:function(E){try{if(l.is(":focus")){var S,b=l.get(0);b.setSelectionRange?b.setSelectionRange(E,E):(S=b.createTextRange(),S.collapse(!0),S.moveEnd("character",E),S.moveStart("character",E),S.select())}}catch(C){}},events:function(){l.on("keydown.mask",function(E){l.data("mask-keycode",E.keyCode||E.which),l.data("mask-previus-value",l.val()),l.data("mask-previus-caret-pos",f.getCaret()),f.maskDigitPosMapOld=f.maskDigitPosMap}).on(a.jMaskGlobals.useInput?"input.mask":"keyup.mask",f.behaviour).on("paste.mask drop.mask",function(){setTimeout(function(){l.keydown().keyup()},100)}).on("change.mask",function(){l.data("changed",!0)}).on("blur.mask",function(){h===f.val()||l.data("changed")||l.trigger("change"),l.data("changed",!1)}).on("blur.mask",function(){h=f.val()}).on("focus.mask",function(E){!0===u.selectOnFocus&&a(E.target).select()}).on("focusout.mask",function(){u.clearIfNotMatch&&!_.test(f.val())&&f.val("")})},getRegexMask:function(){for(var S,b,C,D,R,M,E=[],y=0;y<c.length;y++)S=g.translation[c.charAt(y)],S?(b=S.pattern.toString().replace(/.{1}$|^.{1}/g,""),C=S.optional,D=S.recursive,D?(E.push(c.charAt(y)),R={digit:c.charAt(y),pattern:b}):E.push(C||D?b+"?":b)):E.push(c.charAt(y).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"));return M=E.join(""),R&&(M=M.replace(new RegExp("("+R.digit+"(.*"+R.digit+")?)"),"($1)?").replace(new RegExp(R.digit,"g"),R.pattern)),new RegExp(M)},destroyEvents:function(){l.off(["input","keydown","keyup","paste","drop","blur","focusout",""].join(".mask "))},val:function(E){var C,S=l.is("input"),b=S?"val":"text";return 0<arguments.length?(l[b]()!==E&&l[b](E),C=l):C=l[b](),C},calculateCaretPosition:function(){var E=l.data("mask-previus-value")||"",S=f.getMasked(),b=f.getCaret();if(E!==S){var C=l.data("mask-previus-caret-pos")||0,D=S.length,R=E.length,M=0,y=0,I=0,P=0,A=0;for(A=b;A<D&&!!f.maskDigitPosMap[A];A++)y++;for(A=b-1;0<=A&&!!f.maskDigitPosMap[A];A--)M++;for(A=b-1;0<=A;A--)f.maskDigitPosMap[A]&&I++;for(A=C-1;0<=A;A--)f.maskDigitPosMapOld[A]&&P++;if(b>R)b=10*D;else if(!(C>=b&&C!==R))b>C&&(b+=I-P,b+=y);else if(!f.maskDigitPosMapOld[b]){var T=b;b-=P-I,b-=M,f.maskDigitPosMap[b]&&(b=T)}}return b},behaviour:function(E){E=E||window.event,f.invalid=[];var S=l.data("mask-keycode");if(-1===a.inArray(S,g.byPassKeys)){var b=f.getMasked(),C=f.getCaret();return setTimeout(function(){f.setCaret(f.calculateCaretPosition())},a.jMaskGlobals.keyStrokeCompensation),f.val(b),f.setCaret(C),f.callbacks(E)}},getMasked:function(E,S){var j,x,b=[],C=void 0===S?f.val():S+"",D=0,R=c.length,M=0,y=C.length,I=1,P="push",A=-1,T=0,w=[];u.reverse?(P="unshift",I=-1,j=0,D=R-1,M=y-1,x=function(){return-1<D&&-1<M}):(j=R-1,x=function(){return D<R&&M<y});for(var O;x();){var U=c.charAt(D),G=C.charAt(M),L=g.translation[U];L?(G.match(L.pattern)?(b[P](G),L.recursive&&(-1==A?A=D:D===j&&D!=A&&(D=A-I),j===A&&(D-=I)),D+=I):G===O?(T--,O=void 0):L.optional?(D+=I,M-=I):L.fallback?(b[P](L.fallback),D+=I,M-=I):f.invalid.push({p:M,v:G,e:L.pattern}),M+=I):(!E&&b[P](U),G===U?(w.push(M),M+=I):(O=U,w.push(M+T),T++),D+=I)}var V=c.charAt(j);R!==y+1||g.translation[V]||b.push(V);var N=b.join("");return f.mapMaskdigitPositions(N,w,y),N},mapMaskdigitPositions:function(E,S,b){var C=u.reverse?E.length-b:0;f.maskDigitPosMap={};for(var D=0;D<S.length;D++)f.maskDigitPosMap[S[D]+C]=1},callbacks:function(E){var S=f.val(),b=S!==h,C=[S,E,l,u],D=function(R,M,y){"function"==typeof u[R]&&M&&u[R].apply(this,y)};D("onChange",!0==b,C),D("onKeyPress",!0==b,C),D("onComplete",S.length===c.length,C),D("onInvalid",0<f.invalid.length,[S,E,l,f.invalid,u])}};l=a(l);var _,g=this,h=f.val();c="function"==typeof c?c(f.val(),void 0,l,u):c,g.mask=c,g.options=u,g.remove=function(){var E=f.getCaret();return g.options.placeholder&&l.removeAttr("placeholder"),l.data("mask-maxlength")&&l.removeAttr("maxlength"),f.destroyEvents(),f.val(g.getCleanVal()),f.setCaret(E),l},g.getCleanVal=function(){return f.getMasked(!0)},g.getMaskedVal=function(E){return f.getMasked(!1,E)},g.init=function(E){if(E=E||!1,u=u||{},g.clearIfNotMatch=a.jMaskGlobals.clearIfNotMatch,g.byPassKeys=a.jMaskGlobals.byPassKeys,g.translation=a.extend({},a.jMaskGlobals.translation,u.translation),g=a.extend(!0,{},g,u),_=f.getRegexMask(),E)f.events(),f.val(f.getMasked());else{u.placeholder&&l.attr("placeholder",u.placeholder),l.data("mask")&&l.attr("autocomplete","off");for(var C,S=0,b=!0;S<c.length;S++)if(C=g.translation[c.charAt(S)],C&&C.recursive){b=!1;break}b&&l.attr("maxlength",c.length).data("mask-maxlength",!0),f.destroyEvents(),f.events();var D=f.getCaret();f.val(f.getMasked()),f.setCaret(D)}},g.init(!l.is("input"))};a.maskWatchers={};var t=function(){var l=a(this),c={},u="data-mask-",f=l.attr("data-mask");if(l.attr(u+"reverse")&&(c.reverse=!0),l.attr(u+"clearifnotmatch")&&(c.clearIfNotMatch=!0),"true"===l.attr(u+"selectonfocus")&&(c.selectOnFocus=!0),s(l,f,c))return l.data("mask",new n(this,f,c))},s=function(l,c,u){u=u||{};var f=a(l).data("mask"),g=JSON.stringify,h=a(l).val()||a(l).text();try{return"function"==typeof c&&(c=c(h)),"object"!=typeof f||g(f.options)!==g(u)||f.mask!==c}catch(_){}};a.fn.mask=function(l,c){c=c||{};var u=this.selector,f=a.jMaskGlobals,g=f.watchInterval,h=c.watchInputs||f.watchInputs,_=function(){if(s(this,l,c))return a(this).data("mask",new n(this,l,c))};return a(this).each(_),u&&""!==u&&h&&(clearInterval(a.maskWatchers[u]),a.maskWatchers[u]=setInterval(function(){a(document).find(u).each(_)},g)),this},a.fn.masked=function(l){return this.data("mask").getMaskedVal(l)},a.fn.unmask=function(){return clearInterval(a.maskWatchers[this.selector]),delete a.maskWatchers[this.selector],this.each(function(){var l=a(this).data("mask");l&&l.remove().removeData("mask")})},a.fn.cleanVal=function(){return this.data("mask").getCleanVal()},a.applyDataMask=function(l){l=l||a.jMaskGlobals.maskElements;var c=l instanceof a?l:a(l);c.filter(a.jMaskGlobals.dataMaskAttr).each(t)};var o={maskElements:"input,td,span,div",dataMaskAttr:"*[data-mask]",dataMask:!0,watchInterval:300,watchInputs:!0,keyStrokeCompensation:10,useInput:!/Chrome\/[2-4][0-9]|SamsungBrowser/.test(window.navigator.userAgent)&&function(l){var u,c=document.createElement("div");return l="on"+l,u=l in c,u||(c.setAttribute(l,"return;"),u="function"==typeof c[l]),c=null,u}("input"),watchDataMask:!1,byPassKeys:[9,16,17,18,36,37,38,39,40,91],translation:{0:{pattern:/\d/},9:{pattern:/\d/,optional:!0},"#":{pattern:/\d/,recursive:!0},A:{pattern:/[a-zA-Z0-9]/},S:{pattern:/[a-zA-Z]/}}};a.jMaskGlobals=a.jMaskGlobals||{},o=a.jMaskGlobals=a.extend(!0,{},o,a.jMaskGlobals),o.dataMask&&a.applyDataMask(),setInterval(function(){a.jMaskGlobals.watchDataMask&&a.applyDataMask()},o.watchInterval)},window.jQuery,window.Zepto);(function(a,n,t,s){"use strict";function d(A,T,w){w=w||0,n(parent.document).find("html").animate({scrollTop:A.offset().top+T.offset().top-w},500)}function o(A){A.find(".rslides").responsiveSlides({auto:!1,pager:!1,nav:!0,speed:500})}function l(A){var T=A.data("coords-data"),w=null,j=[];if(n.isArray(T))if(1===T.length)w=new s.Map(A.attr("id"),{center:[+T[0].lat,+T[0].lng],zoom:9,controls:["zoomControl","fullscreenControl"]}),w.geoObjects.add(new s.Placemark(w.getCenter(),{balloonContent:T[0].content}));else{w=new s.Map(A.attr("id"),{center:[0,0],zoom:8,controls:["zoomControl","fullscreenControl"]});for(var x=0;x<T.length;x++)j.push([T[x].lat,T[x].lng]);s.route(j,{mapStateAutoApply:!0}).then(function(O){var G,U=O.getWayPoints();w.geoObjects.add(O),U.options.set("preset","islands#blueStretchyIcon");for(var L=0;L<T.length;L++)G=U.get(L),G.properties.set("iconContent",T[L].title),G.options.set("hasBalloon",!1)})}}function c(A){A.css({opacity:0.4})}function u(A){A.css({opacity:1})}function f(A,T,w,j){var x=a.utils.makeid();return`<div class="panel panel-default">
                        <div class="panel-heading">
                          <h4 class="panel-title">
                                  <a class="panel-collapser" data-toggle="collapse" data-parent="#${w}" href="#collapse-${x}">
                                    ${A}
                                  </a>
                            </h4>
                        </div>
                        <div id="collapse-${x}" class="panel-collapse collapse ${j}">
                          <div class="panel-body">
                              ${T}
                          </div>
                        </div>
                    </div>`}function g(A,T){document.body.innerHTML=A,a.utils.HWatcher.__parent=window.parent.document.getElementById("search-result_"+T),a.utils.HWatcher.watch(document.getElementById("container"))}function h(A){var T=a.utils.screen;P[A.pager.page]=`<div class="container" id="container">
                                                        ${function(w){return w.length?w.map(function(j){return`<div class="row thumbnail mrtb-10">
                                                                                    <div class="row-flex row-flex-wrap">
                                                                                        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                                                                                        ${function(x){return x?`<img class="main-img" src="${T(a.SITE_ADDRESS+j.imgSrc)}">`:``}(j.imgSrc)}
                                                                                        </div>
                                                                                        <div class="col-lg-8 col-md-8 col-sm-8 col-xs-12 flex-col">
                                                                                            <div class="name">${T(j.name)}</div>
                                                                                            <div class="stars-block">
                                                                                                ${function(x){for(var O=``,U=1;U<=x;U++)O+=`<span class="glyphicon glyphicon-star" aria-hidden="true"></span>`;return O}(j.stars)}
                                                                                            </div>
                                                                                            <ul>
                                                                                         ${function(x){var O="";return x.address&&(O+=`<li><span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span> ${T(x.address)}</li>`),x.route&&(O+=`<li><span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span> ${T(x.route)}</li>`),x.days&&(O+=`<li><span class="glyphicon glyphicon-time" aria-hidden="true"></span> Количество дней: ${T(x.days)}</li>`),x.duration_time&&(O+=`<li><span class="glyphicon glyphicon-time" aria-hidden="true"></span> Количество часов: ${T(x.duration_time)}</li>`),j.text.distance.minsk&&(O+=`<li><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> Расстояние до Минска: ${T(j.text.distance.minsk)} км</li>`),j.text.distance.center&&(O+=`<li><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> Расстояние до цента: ${T(j.text.distance.center)} км</li>`),j.text.distance.airport&&(O+=`<li><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> Расстояние до аэропорта: ${T(j.text.distance.airport)} км</li>`),O}(j.text)}
                                                                                                
                                                                                            </ul>
                                                                                            <div class="show-offers-block flex-grow">
                                                                                                <div class="details-links">
                                                                                                    <a data-request='${JSON.stringify(j.request)}' class="detail-link __desc" href="#">Описание</a>
                                                                                                    <a data-request='${JSON.stringify(j.request)}' class="detail-link __on-map" href="#">На карте</a>
                                                                                                    <a data-request='${JSON.stringify(j.request)}' class="detail-link __video" href="#">Видео</a>
                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="show-offers-block flex-grow">
                                                                                                    <button data-offers-request='${JSON.stringify(j.request)}' class="btn btn-primary show-offers" type="button"><span class="price-from">${j.text.price}</span> <span class="chevron glyphicon glyphicon-chevron-down" aria-hidden="true"></button>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>`}).join(""):`<div class="row">
                                                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 not-found-text">По Вашему запросу ничего не найдено. Пожалуйста, измените параметры поиска или оставьте заявку.</div>
                                                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 callback-form">
                                                                    <div class="form-group">
                            <label for="full_name">ФИО<span class="star">*</span></label>
                            <span class="error-container"></span>
                            <input placeholder="Иван Иванович Иванов" name="full_name" value="" type="text" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="phone">Телефон</label>
                            <span class="error-container"></span>
                            <input placeholder="+375441111111" name="phone" type="phone" value="" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="email">Email<span class="star">*</span></label>
                            <span class="error-container"></span>
                            <input placeholder="example@gmail.com" name="email" type="email" value="" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="date">Дата<span class="star">*</span></label>
                            <span class="error-container"></span>
                            <input placeholder="dd.mm.yyyy" name="date" type="text" value="" class="form-control">
                            
                        </div>
                        <div class="form-group">
                            <label for="comment">Текст заявки<span class="star">*</span></label>
                            <span class="error-container"></span>
                            <textarea name="comment" class="form-control"></textarea>
                        </div>
                        <div class="form-group text-right">
                            <button type="button" id="callback-sender-btn" class="btn btn-primary">Отправить</button>
                        </div>
                                                                </div>
                                                                                </div><img style="display: none;" src="" onerror="jQuery('.callback-form input[name=date]').mask('00.00.0000');">`}(A.items||[])}
                                                        <div class="row text-right">${function(w){return new t(function(j){for(var x=[],O=0;O<j;O++)x.push(O);return x}(w.records),w.numberPerPage).page(w.page).getHtml()}(A.pager)}
                                        </div>
                                                </div>`,g(P[A.pager.page],A.main_container)}function _(A){"string"==typeof P[A.page]?g(P[A.page],A.insertion_id):a.utils.sendRequest("GetSearchResultRenderData",[function(){var T=window.parent.location.search.replace("?","").split("&").filter(function(w){return 0<w.length&&0===w.indexOf("tpm_params")});return T.push("tpm_params[type]="+A.type),T.push("tpm_params[page]="+A.page),T.push("tpm_params[citizen_price]="+A.citizen_price),T.push("tpm_params[number_per_page]="+A.numberPerPage),T.push("tpm_params[agent]="+A.agent),T.push("tpm_params[hash]="+A.hash),T.join("&")}()],function(T){return function(w){var j=w;return j.isError?(console.warn(w.errorMessage),void h({items:[],pager:{page:1,numberPerPage:0},main_container:T.insertion_id})):void(j.data.pager.numberPerPage=T.numberPerPage,j.data.main_container=T.insertion_id,h(j.data))}}(A))}function E(A,T,w){var j=n(".pagination li.active a").data("page"),x=a.utils.screen;T.find(".info-block").remove(),T.append(`
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 collapsing-block offers hidden">
                <div style="width: 100%">
                    ${function(O){for(var U="",G=0;G<O.length;G++)U+=`<div class="row offer-row mrtb-10">
                                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-6">
                                    ${O[G].date?`<b>${x(O[G].date)}</b>`:O[G].img_src?`<img class="main-img" src="${a.SITE_ADDRESS+"/"+x(O[G].img_src)}">`:``}</b>
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-6">
                                    ${O[G].service?`<div class="name">${x(O[G].service)}</div><h5>${x(O[G].rate)}</h5>`:`<div class="name">${x(O[G].service)}</div>`}
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 text-right">
                                    <b>${x(O[G].price)}</b>${O[G].citizenprice?`<br><small>${O[G].citizenprice}</small>`:``}
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 text-right">
                                    <button data-add2cart="${x(O[G].add2cart)}" class="btn btn-primary booking" type="button">Бронировать</button>
                                    ${0<O[G].rate_desc.length?`<div class="about-rate"><a role="button" href="javascript:void(0)">О тарифе</a></div>`:``}
                                    ${"object"!=typeof O[G].room_desc||n.isArray(O[G].room_desc)?``:`<div class="about-room"><a role="button" href="javascript:void(0)">О номере</a></div>`}
                                </div>
                            ${0<O[G].rate_desc.length?`<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 rate-desc hidden">
                                        <div class="rate-desc-text">${x(O[G].rate_desc)}</div>
                                </div>`:``}
                                
                                ${"object"!=typeof O[G].room_desc||n.isArray(O[G].room_desc)?``:`<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 room-desc hidden">
                                            ${0<O[G].room_desc.SQUARE?`<div class="square"><b>Площадь</b>: ${x(O[G].room_desc.SQUARE)}</div>`:``}
                                            ${0<O[G].room_desc.BAD1?`<div class="bad_1"><b>Количество одноместных кроватей</b>: ${x(O[G].room_desc.BAD1)}</div>`:``}
                                            ${0<O[G].room_desc.BAD2?`<div class="bad_2"><b>Количество двухместных кроватей</b>: ${x(O[G].room_desc.BAD2)}</div>`:``}
                                            ${0<O[G].room_desc.SOFA_BAD?`<div class="sofa-bad"><b>Количество диван-кроватей</b>: ${x(O[G].room_desc.SOFA_BAD)}</div>`:``}
                                            ${0<O[G].room_desc.PLACES_MAIN?`<div class="main-places"><b>Количество основных мест</b>: ${x(O[G].room_desc.PLACES_MAIN)}</div>`:``}
                                            ${0<O[G].room_desc.PLACES_ADD?`<div class="add-places"><b>Количество дополнительных мест</b>: ${x(O[G].room_desc.PLACES_ADD)}</div>`:``}
                                            ${0<O[G].room_desc.PEOPLE?`<div class="people"><b>Максимальное количество человек</b>: ${x(O[G].room_desc.PEOPLE)}</div>`:``}
                                            ${typeof n.isArray(O[G].room_desc.SERVICES)&&0<O[G].room_desc.SERVICES.length?`<div class="people"><b>Услуги</b>: ${O[G].room_desc.SERVICES.join(", ")}</div>`:``}
                                            ${0<O[G].room_desc.DESC?`<div class="room-desc-text">${x(O[G].room_desc.DESC)}</div>`:``}
                                </div>`}
                                
                            </div>`;return U}(A)}
                </div>
            </div>
        `),T.find(".offers").removeClass("hidden"),"function"==typeof w&&w()}function S(A,T,w){T.find(".info-block").remove(),T.append(`
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 collapsing-block info-block hidden">
                <div style="width: 100%">${A.message}</div>
        </div>`),T.find(".info-block").removeClass("hidden"),"function"==typeof w&&w()}function b(A){A.find("span.chevron").removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up")}function C(){n(".show-offers").each(function(){D(n(this))})}function D(A){A.find("span.chevron").removeClass("glyphicon-chevron-up").addClass("glyphicon-chevron-down")}function R(A,T,w){var j=null===A?null:A.hasClass("hidden");n(".collapsing-block").addClass("hidden"),null===j?"function"==typeof T&&T():j?(A&&A.removeClass("hidden"),"function"==typeof T&&T()):(A&&A.addClass("hidden"),"function"==typeof w&&w())}function M(A,T,w){var j=n(".pagination li.active a").data("page"),x=a.utils.makeid(),O="accordion-"+a.utils.makeid(),U="in";T.find(".info-block").remove(),T.append(`
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 collapsing-block detail-desc-block hidden">
                
                    ${function(G){var L=``;return n.isArray(G.pictures.big)&&(L+=`<section id="${x}" class="detail-slider">
                                    <ul class="rslides">
                                        ${function(V){L="";for(var N=0;N<V.length;N++)L+=`<li><img src="${a.SITE_ADDRESS+V[N]}"></li>`;return L}(G.pictures.big)}
                                    </ul>
                            </section>`),L+=`<div class="panel-group" id="${O}">`,G.desc&&(L+=f("\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435",G.desc,O,U),U=""),G.program&&(L+=f("\u041F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0430 \u0442\u0443\u0440\u0430",G.program,O,U),U=""),G.profiles&&(L+=f("\u041F\u0440\u043E\u0444\u0438\u043B\u044C",function(V){var N=`<div class="featured-service">`;for(var q in V.TYPE_GROUP)N+=`<div class="list-service-section">${V.TYPE_SECTIONS?`${V.TYPE_SECTIONS[q].PICTURE.SRC?`<div class="icon-service" style="float:left; top:2px"><img src="${a.SITE_ADDRESS+V.TYPE_SECTIONS[q].PICTURE.SRC}"></div>`:``}
                                                                            <h4>${V.TYPE_SECTIONS[q].TITLE}</h4>`:``}
                                                                            
                                                                        </div>
                                                                        <ul class="service-accmd">
                                                                            ${function(B){var W="";for(var Q in B)W+=`<li><div><img src="${a.SITE_ADDRESS}/local/templates/travelsoft/images/icon-check.png" alt=""></div>${B[Q].TITLE} ${B[Q].PAID?`<a data-content="За дополнительную плату">(<i class="fa fa-dollar"></i>)</a>`:``}</li>`;return W}(V.TYPE_GROUP[q])}
                                                                        </ul>`;return N+="</div>",N}(G.profiles),O,U),U=""),G.services&&(L+=f("\u0423\u0441\u043B\u0443\u0433\u0438",function(V){var N=`<div class="featured-service">`;for(var q in V.SERVICES_GROUP)N+=`<div class="list-service-section">
                                                                            ${V.SERVICES_SECTIONS[q].PICTURE.SRC?`<div class="icon-service" style="float:left; top:2px"><img src="${a.SITE_ADDRESS+V.SERVICES_SECTIONS[q].PICTURE.SRC}"></div>`:``}
                                                                            <h4>${V.SERVICES_SECTIONS[q].TITLE}</h4>
                                                                        </div>
                                                                        <ul class="service-accmd">
                                                                            ${function(B){var W="";for(var Q in B)W+=`<li><div><img src="${a.SITE_ADDRESS}/local/templates/travelsoft/images/icon-check.png" alt=""></div>${B[Q].TITLE}</li>`;return W}(V.SERVICES_GROUP[q])}
                                                                        </ul>`;return N+="</div>",N}(G.services),O,U),U=""),G.medecine_services&&(L+=f("\u041C\u0435\u0434\u0438\u0446\u0438\u043D\u0441\u043A\u0438\u0435 \u0443\u0441\u043B\u0443\u0433\u0438",function(V){var N=`<div class="featured-service">`;for(var q in V.MED_SERVICES_GROUP)N+=`<div class="list-service-section">
                                                                            <h4>${V.MED_SERVICES_SECTIONS[q].TITLE}</h4>
                                                                        </div>
                                                                        <ul class="service-accmd">
                                                                            ${function(B){var W="";for(var Q in B)W+=`<li><div><img src="${a.SITE_ADDRESS}/local/templates/travelsoft/images/icon-check.png" alt=""></div>${B[Q].TITLE} ${B[Q].PAID?`<a data-content="За дополнительную плату">(<i class="fa fa-dollar"></i>)</a>`:``}</li>`;return W}(V.MED_SERVICES_GROUP[q])}
                                                                        </ul>`;return N+="</div>",N}(G.medecine_services),O,U),U=""),G.children_services&&(L+=f("\u0423\u0441\u043B\u0443\u0433\u0438 \u0434\u043B\u044F \u0434\u0435\u0442\u0435\u0439",G.children_services,O,U),U=""),G.food&&(L+=f("\u041F\u0438\u0442\u0430\u043D\u0438\u0435",G.food,O,U),U=""),G.rooms_base&&(L+=f("\u041D\u043E\u043C\u0435\u0440\u043D\u0430\u044F \u0431\u0430\u0437\u0430",G.rooms_base,O,U),U=""),G.addinfo&&(L+=f("\u0414\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u0430\u044F \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F",G.addinfo,O,U),U=""),L+=`</div>`,L}(A)}
                
            </div>
        `),T.find(".detail-desc-block").removeClass("hidden"),"function"==typeof w&&w(),o(n("#"+x))}function y(A,T,w){var j=n(".pagination li.active a").data("page"),x="map-"+a.utils.makeid();T.find(".info-block").remove(),T.append(`<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 collapsing-block show-on-map-block hidden">
                                        <div style="width: 100%">
                                            <div data-coords-data='${JSON.stringify(A)}' id="${x}"></div>
                                        </div>
                                    </div>`),T.find(".show-on-map-block").removeClass("hidden"),"function"==typeof w&&w(),l(n(`#${x}`))}function I(A,T,w){n(".pagination li.active a").data("page");T.find(".info-block").remove(),T.append(`<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 collapsing-block video-block hidden">
                                        <div style="width: 100%">
                                            <iframe class="video-frame" height="100%" width="100%" style="border: none;" src="${a.VIDEO_URL+A.code}" allowfullscreen=""></iframe>
                                        </div>
                                    </div>`),T.find(".video-block").removeClass("hidden"),"function"==typeof w&&w()}var P={};a.searchResult={init:function(A){var T=A;_(T),n(document).on("click",".show-offers",function(w){var j=n(this),x=j.closest(".thumbnail"),O=x.find(".offers");O.length?R(O,function(){b(j)},function(){D(j)}):(R(null,function(){C()}),b(j),c(j),S({message:"\u0418\u0434\u0435\u0442 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u043F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u0439. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u043E\u0434\u043E\u0436\u0434\u0438\u0442\u0435..."},x),a.utils.sendRequest("GetOffersRenderData",[j.data("offers-request").join("&")],function(U){return function(G){return G.isError?(console.warn(G.errorMessage),void S({message:"\u041F\u0440\u0435\u0434\u043B\u043E\u0436\u0435\u043D\u0438\u044F \u043E\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044E\u0442."},U,function(){u(j)})):void E(G.data,U,function(){u(j)})}}(x))),w.preventDefault()}),n(document).on("click",".about-rate",function(w){n(this).closest(".offer-row").find(".rate-desc").toggleClass("hidden"),w.preventDefault()}),n(document).on("click",".about-room",function(w){n(this).closest(".offer-row").find(".room-desc").toggleClass("hidden"),w.preventDefault()}),n(document).on("click",".detail-link.__desc",function(w){var j=n(this),x=j.closest(".thumbnail"),O=x.find(".detail-desc-block");O.length?R(O,function(){C()},function(){C()}):(R(null,function(){C()},function(){C()}),c(j),S({message:"\u0418\u0434\u0435\u0442 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u0438. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u043E\u0434\u043E\u0436\u0434\u0438\u0442\u0435..."},x),a.utils.sendRequest("GetDetailDescriptionRenderData",[j.data("request").join("&")],function(U){return function(G){return G.isError?(console.warn(G.errorMessage),void S({message:"\u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F \u043E\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442."},U,function(){u(j)})):void M(G.data,U,function(){u(j)})}}(x))),w.preventDefault()}),n(document).on("click",".detail-link.__on-map",function(w){var j=n(this),x=j.closest(".thumbnail"),O=x.find(".show-on-map-block");O.length?R(O,function(){C()},function(){C()}):(R(null,function(){C()},function(){C()}),c(j),S({message:"\u0418\u0434\u0435\u0442 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u043A\u0430\u0440\u0442\u044B. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u043E\u0434\u043E\u0436\u0434\u0438\u0442\u0435..."},x),a.utils.sendRequest("GetDetailMapRenderData",[j.data("request").join("&")],function(U){return function(G){return G.isError?(console.warn(G.errorMessage),void S({message:"\u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F \u043E\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442."},U,function(){u(j)})):void y(G.data,U,function(){u(j)})}}(x))),w.preventDefault()}),n(document).on("click",".detail-link.__video",function(w){var j=n(this),x=j.closest(".thumbnail"),O=x.find(".video-block");O.length?R(O,function(){C()},function(){C()}):(R(null,function(){C()},function(){C()}),c(j),S({message:"\u0418\u0434\u0435\u0442 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0432\u0438\u0434\u0435\u043E. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u043E\u0434\u043E\u0436\u0434\u0438\u0442\u0435..."},x),a.utils.sendRequest("GetDetailVideoRenderData",[j.data("request").join("&")],function(U){return function(G){return G.isError?(console.warn(G.errorMessage),void S({message:"\u0412\u0438\u0434\u0435\u043E \u043E\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442."},U,function(){u(j)})):G.data.code?void I(G.data,U,function(){u(j)}):void S({message:"\u0412\u0438\u0434\u0435\u043E \u043E\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442."},U,function(){u(j)})}}(x))),w.preventDefault()}),n(document).on("click",".pagination a",function(w){w.preventDefault(),n(this).parent().hasClass("active")||(T.page=n(this).data("page"),_(T))}),n(document).on("click",".booking",function(w){var j=n(this).data("add2cart");w.preventDefault(),j?window.parent.open(a.REQUEST_URL+"/?method=Booking&tpm_params[add2cart]="+j):alert("Some error. Please, try later.")}),n(document).on("click",".panel-collapser",function(){d(n(this),n(parent.document).find("#"+A.insertion_id),100)}),n(document).on("click","#callback-sender-btn",function(){var w=n(this),j=w.closest(".callback-form"),x={full_name:j.find("input[name='full_name']").val(),phone:j.find("input[name='phone']").val(),email:j.find("input[name='email']").val(),date:j.find("input[name='date']").val(),comment:j.find("textarea[name='comment']").val(),agent_id:A.agent},O=!1;for(var U in j.find(".error-container").html(""),x)"full_name"===U?2>=x[U].length&&(O=!0,j.find("input[name='full_name']").prev(".error-container").text(`Укажите ФИО`)):"comment"===U?2>=x[U].length&&(O=!0,j.find("textarea[name='comment']").prev(".error-container").text(`Укажите текст заявки`)):"phone"===U?0<x[U].length&&!/^\s*(?:\+?(\d{1,3}))?([-. (]*(\d{3})[-. )]*)?((\d{3})[-. ]*(\d{2,4})(?:[-.x ]*(\d+))?)\s*$/gm.test(x[U])&&(O=!0,j.find("input[name='phone']").prev(".error-container").text(`Укажите телефон в международном формате`)):"email"===U?/^[-._a-z0-9]+@(?:[a-z0-9][-a-z0-9]+\.)+[a-z]{2,6}$/.test(x[U])||(O=!0,j.find("input[name='email']").prev(".error-container").text(`Укажите корректный email`)):"date"===U?x[U].length||(O=!0,j.find("input[name='date']").prev(".error-container").text(`Укажите дату`)):void 0;O?d(j,j):(w.prop("disabeled",!0).css({opacity:.5}),a.utils.sendRequest("SendCallbackForm",[n.param({tpm_params:x})],function(G,L){return function(V){return G.parent().find(".not-found-text").remove(),G.html(""),L.remove(),d(G,G),V.isError?void G.html(`<span class="error-container">Произошла ошибка при попытке отправить заявку. Пожалуйста, попробуйте повторить поиск через 5 минут.</span>`):V.data.isOk?void G.html(`<span class="message-ok">Спасибо! Ваша заявка принята. Втечение 15 минут наши менеджеры свяжутся с Вами.</span>`):void 0}}(j,w)))})}}})(Travelsoft,jQuery,PageNavigator,ymaps);